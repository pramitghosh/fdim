---
title: "Working with `fdim`"
author: "Pramit Ghosh"
date: '`r Sys.Date()`'
output:
  html_document: default
vignette: |
  %\VignetteIndexEntry{Working with fdim}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---
This vignette aims at providing an overview of how the calculation of the fractal dimension using the box-counting technique is carried out and then proceeds to give detailed instructions on how to calculate it using this package.

# Introduction to how the box-counting technique works

The fdim package is used for calculating the fractal dimension of a single polygonal feature stored in an ESRI Shapefile using the box-counting technique. It is done by performing the following important steps:

- Importing the shapefile and calculating the extents of the polygon
- Overlaying a grid of square cells on top of this polygon
- Fill out a 5-by-2 matrix row-by-row with the size of the cell and the number of such cells required to completely cover the polygon
- Decrease the size of the cell and repeat the previous step until the matrix has been populated
- Plot a log-log scatterplot of the number of cells vs. the reciprocal of cell size
- Calculate the best-fit line through these points and find its slope
- Report the slope of this line as the fractal dimension of the polygon

# Step-by-step procedure to calculate the fractal dimension

In order for the program to work correctly, the following conditions must be met before importing the shapefile:

* The file should be in ESRI shapefile format with the extension being .shp
* It must have its auxillary files with the same name (but different extensions) in the same directory
* The file must contain a *single polygon* feature in it

If all of the above conditions are met, performing the following steps will calculate the fractal dimension.

## Generating the matrix:
The first step is to call the function `mb_dim`. The result obtained by calling this     function needs to be stored in a variable for the actual calculation of the fractal dimension. This function (`mb_dim`) can be called in two ways: with or without arguments.

### `mb_dim` with arguments:
The following code shows the function called **with arguments**:
```{r}
fdim_matrix = fdim::mb_dim(directory = system.file(package = "fdim"), shapefile = "madhya_pradesh")
```
The following points should be noted when calling the function with arguments:

* The first argument (`directory`) should evaulate to the directory path where the shapefile is located without the last trailing slash.
* The second argument (`shapefile`) should name the shapefile in *that* directory without the extension.

So, for example, if the location of the shapefile is: `C:\abc\def\xyz.shp`, then the `mb_dim` function should be called in the following manner:
```
fdim_matrix = mb_dim(directory = "C:\abc\def", shapefile = "xyz")
```
### `mb_dim` without arguments:
`mb_dim` can also be called without passing arguments. When called in this mode, it will prompt the user for the two arguments one-by-one.
```
fdim_matrix = mb_dim()
```
The program will prompt the user to enter the directory as follows:
```
Please enter the directory without the trailing slash:
```
The user needs to enter the directory path in the same manner described above and press return. At this point, the program will prompt for a filename within that directory:
```
Please enter the directory without the trailing slash: C:\abc\def
Please enter the filename without the extension:
```
After entering the filename (in the same manner), the user should hit return.
```
Please enter the directory without the trailing slash: C:\abc\def
Please enter the filename without the extension: xyz
```
If a valid file was given, the user should see some statistics regarding the shapefile.

## Calculating the fractal dimension:
To view the fractal dimension of the polygon, the result from calling `mb_dim` needs to be passed to the generic method `summary`. The following piece of code illustrates the use:
```{r}
summary(fdim_matrix)
```

## Viewing the scatterplot and the best-fit line (optional):
The best-fit line to the log-log scatterplot can be seen by calling the generic `plot`. It is to be called with the result from `mb_dim` as its argument, as shown below:
```{r}
plot(fdim_matrix)
```

In the above scatter-plot, the x- and y-axes represent the reciprocal of cell-size (1/e) and the number of cells needed to cover the polygon (N), both on a (natural) logarithmic scale. A best-fit line is also seen for the discrete points that were calculated. The slope of this best-fit line essentially represent the fractal dimension of the polygon.
